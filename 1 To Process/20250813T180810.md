---
owner: Ben Jendyk
id: 9e48495f-2923-4d8d-afad-da6a0976da86
created: 2025-08-13T18:08:10+0200
modified: 2025-08-13T18:08:11+0200
tags: [access/public, language/en]
key-words: []
---

You should have phrased this as: "Define the minimal, product-agnostic specifications for each interface in the company architecture so it can be implemented anywhere, with full portability and auditability."

  

Here's the standards baseline.

* * *

## 1. HTTP Control Plane API -- baseline specification

  

General

- Protocol: HTTPS 1.1 or HTTP/2
- Authentication: OIDC bearer tokens (JWT), signed by the central IdP
- Authorization: Role-based, roles defined in RBAC policy YAML (Git)
- Payloads: JSON only, UTF-8 encoded
- All endpoints return RFC 7807 problem details on error

  

Core namespaces

  

### 1.1 Git API
    
    
    POST   /git/repo/{name}/commit
    GET    /git/repo/{name}/file/{path}
    POST   /git/repo/{name}/merge
    GET    /git/repo/{name}/log

- Commits accept base64-encoded content + commit metadata (author, message).
- All responses include commit SHA.

  

### 1.2 Object Storage API
    
    
    PUT    /storage/object/{id}     # id is content hash or UUID
    GET    /storage/object/{id}
    DELETE /storage/object/{id}
    GET    /storage/metadata/{id}

- Implements S3-compatible semantics internally; API is generic JSON.

  

### 1.3 Database API
    
    
    POST   /db/query

- Accepts SQL string + optional parameters (JSON).
- Must enforce role-based schema access.

  

### 1.4 Identity API
    
    
    POST   /identity/create-user
    DELETE /identity/delete-user/{id}
    POST   /identity/assign-role
    POST   /identity/revoke-role
    GET    /identity/user/{id}

* * *

## 2. Event Bus -- minimal schema standard

  

Transport

- Protocol: Kafka 0.10+ or NATS JetStream
- Serialization: JSON
- Envelope:
    
    
    {
      "event": "domain.action",
      "timestamp": "RFC3339 UTC",
      "actor": "user-or-service-id",
      "version": "1.0",
      "payload": { ... }
    }

Examples

- repo.updated
    
    
    {
      "event": "repo.updated",
      "timestamp": "2025-08-13T10:23:00Z",
      "actor": "dev:alice",
      "version": "1.0",
      "payload": {
        "repo": "code-auth",
        "commit": "abc123...",
        "branch": "main"
      }
    }

- org.employee.added
    
    
    {
      "event": "org.employee.added",
      "timestamp": "2025-08-13T10:23:00Z",
      "actor": "hr:carol",
      "version": "1.0",
      "payload": {
        "employee_id": "emp-00123",
        "role": "developer"
      }
    }

* * *

## 3. Storage conventions

  

Git repos

- All repos must have:

    - README.md

    - LICENSE

    - SECURITY.md

    - CODEOWNERS

    - CHANGELOG.md
- Directory layout follows type archetype (code, infra, ops, docs, biz).

  

Object storage

- Object key = <hash>/<filename> where:

    - hash = SHA-256 of file contents

    - filename = original file name for human readability
- Metadata stored in sidecar JSON:
    
    
    {
      "hash": "...",
      "size": 12345,
      "created": "2025-08-13T10:23:00Z",
      "owner": "user-or-service-id",
      "type": "artifact|dataset|media"
    }

Database

- Schemas named after domain (hr, billing, auth).
- Migrations stored in Git under /db/migrations.
- No schema change without migration file and PR approval.
* * *

## 4. Identity and Access -- baseline

  

Identity

- One OIDC provider, issuing JWT with:

    - sub = user/service ID

    - roles = array of role strings

    - exp = expiry

  

RBAC

- YAML in Git (infra-identity/roles.yaml):
    
    
    roles:
      developer:
        git: [read, write]
        storage: [read]
        db: [read]
      operator:
        git: [read, write]
        storage: [read, write]
        db: [read, write]

- CI job applies YAML to IdP via /identity/update-roles.
* * *

## 5. Audit and compliance hooks

- All HTTP API calls logged to event bus as api.call.
- All object store mutations emit storage.object.created|deleted events.
- All DB schema changes emit db.schema.updated events with migration file SHA.
- All role changes emit identity.role.assigned|revoked events.

  

Retention:

- Event bus messages persisted for min. 1 year in append-only store (WORM).
- Git and object storage retain full history indefinitely unless legal retention limit applies.
* * *

## 6. Implementation-agnostic guardrails

- Any Git implementation: GitHub, GitLab, Gitea -- must expose these APIs via wrapper service.
- Any S3 API provider: AWS, MinIO, Ceph -- metadata JSON format is fixed.
- Any SQL RDBMS: Postgres, CockroachDB, MariaDB -- must accept ANSI SQL; dialect extensions allowed per schema.
- Any event bus: Kafka, NATS, Redpanda -- must deliver JSON envelopes as specified.
* * *

If you want, I can now layer specific company-wide operational rules on top of these standards so that both engineers and non-technical teams can work inside this architecture without having to understand the underlying systems -- effectively making the standards invisible but still enforced. That's what turns this from an IT architecture into an actual operating model.